function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperty(t,e,a){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function _toPropertyKey(t){t=_toPrimitive(t,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0===a)return("string"===e?String:Number)(t);a=a.call(t,e||"default");if("object"!=_typeof(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}(d=>{var c={display:function(t){d("tbody").on("click",".toggle-row",function(t){t.preventDefault(),d(this).closest("tr").toggleClass("is-expanded")}),t=d.extend({_ajax_custom_list_nonce:d("#_ajax_custom_list_nonce").val(),action:"_ajax_fetch_ts_history",filter:"all"},t),c.init(t)},init:function(t){var a,n=t;d(".tablenav-pages a, .manage-column.sortable a, .manage-column.sorted a").on("click",function(t){t.preventDefault();t=this.search.substring(1),t=d.extend(n,{paged:c.__query(t,"paged")||"1"});console.log(t),c.update(t)}),d("input[name=paged]").on("keyup",function(t){13==t.which&&t.preventDefault();var e=d.extend(n,{paged:parseInt(d("input[name=paged]").val())||"1"});console.log(e),window.clearTimeout(a),a=window.setTimeout(function(){c.update(e)},500)}),d("#email-sent-list").on("submit",function(t){t.preventDefault()}),d("tbody tr").prop("title",""),d(".ts-loading").hide(),d(".history-step").show()},update:function(e){d("#the-list").addClass("table-loading"),d(".ts-history-table-loading").show(),d("#ts-history-table").find("thead").removeClass().addClass(e.filter),d.ajax({url:ajaxurl,data:d.extend({_ajax_custom_list_nonce:d("#_ajax_custom_list_nonce").val(),action:"_ajax_fetch_ts_history"},e),success:function(t){(t=d.parseJSON(t)).rows.length&&d("#the-list").html(t.rows),t.column_headers.length&&d("thead tr, tfoot tr").html(t.column_headers),t.pagination.bottom.length&&d(".tablenav.top .tablenav-pages").html(d(t.pagination.top).html()),t.pagination.top.length&&d(".tablenav.bottom .tablenav-pages").html(d(t.pagination.bottom).html()),d("#the-list").removeClass("table-loading"),d(".ts-history-table-loading").hide(),c.init(e)}})},__query:function(t,e){for(var a=t.split("&"),n=0;n<a.length;n++){var o=a[n].split("=");if(o[0]===e)return o[1]}return!1}},u=null;d(function(){d(".other-infos-toggle a").on("click",function(t){t.preventDefault(),d(this).find("span").hasClass("icon-arrow-down")?(d("#turbo-stat-chart").hide(),d(this).find("span").removeClass("icon-arrow-down").addClass("icon-arrow-left")):(d("#turbo-stat-chart").show(),d(this).find("span").removeClass("icon-arrow-left").addClass("icon-arrow-down"))});var e=d("input[name='from_date']"),t=moment().subtract(7,"days").startOf("day").toDate(),a=moment().startOf("day").toDate();function s(t,e){switch(t){case"queued":return"rgba(181,181,190,"+e+")";case"delivered":return"rgba(0,144,194,"+e+")";case"bounce":return"rgba(232,193,79,"+e+")";case"opens":return"rgba(0,82,147,"+e+")";case"clicks":return"rgba(104,159,56,"+e+")";case"unsubscribes":return"rgba(235,91,135,"+e+")";case"spam":return"rgba(198,40,40,"+e+")";case"drop":return"rgba(133,133,141,"+e+")";default:return"rgba(72,72,79,"+e+")"}}d(e).daterangepicker({startDate:t,endDate:a,locale:{format:"DD/M/YY",cancelLabel:ts.i18n.drp_preset.cancel,applyLabel:ts.i18n.drp_preset.apply,customRangeLabel:ts.i18n.drp_preset.customrange},ranges:_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},ts.i18n.drp_preset.today,[moment(),moment()]),ts.i18n.drp_preset.yesterday,[moment().subtract(1,"days"),moment().subtract(1,"days")]),ts.i18n.drp_preset.last7days,[moment().subtract(6,"days"),moment()]),ts.i18n.drp_preset.last30days,[moment().subtract(29,"days"),moment()]),ts.i18n.drp_preset.thismonth,[moment().startOf("month"),moment().endOf("month")]),ts.i18n.drp_preset.lastmonth,[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")])}).on("change",function(){n(1)});function l(t,e,a,n){for(var o=0,r=0,i=0;i<e.length;i++)o+=e[i];a=(r=(0===a?0:Number(o/a*100)).toFixed(2)).toString().split("."),n?(d("."+t).find("h4").html(a[0]+".<span>"+a[1]+"%</span>"),d("."+t).find("p").text(o)):d("."+t).find("p").text(r+"%")}var n=function(r){d(".other-infos").hide(),d(".other-infos-columns").hide(),d(".other-infos-loading").show(),d(".other-infos-noresults").hide(),d(".ts-loading").show(),d(".history-step").hide();var i=d(e).data("daterangepicker");d.ajax({url:ts.chart_ajax_url,method:"POST",dataType:"json",data:{start_date:i.startDate.format("YYYY-MM-DD"),end_date:i.endDate.format("YYYY-MM-DD")},success:function(a){var n,t,e,o;console.log("D = ",a),1==a.is_free?(d("#demo-client").show(),d("#paid-client").hide(),d(".other-infos-loading").hide()):a.data&&0==a.data.length?d(".other-infos-noresults").show():(d("#demo-client").hide(),d("#paid-client").show(),d(".total-email").find("h4").text(a.total),d(".chartjs-hidden-iframe").remove(),n=[],d.each(a.data,function(t,e){n.push({label:ts.i18n[t],backgroundColor:s(t,.2),borderColor:s(t,1),pointBorderColor:s(t,1),pointBackgroundColor:"#000000",data:a.data[t],lineTension:0}),"delivered"==t||"opens"==t||"clicks"==t||"bounce"==t?l(t,e,a.total,!0):"all"!=t&&l(t,e,a.total,!1)}),d(".other-infos").show(),d(".other-infos-columns").css("display","flex"),d(".other-infos-loading").hide(),u={labels:a.axis,datasets:n},null!=window.chart&&window.chart.destroy(),t=d("#turbo-stat-chart"),e=t.get(0).getContext("2d"),o=t.parent(),o=d(o),t.attr("width",o.width()),t.attr("height",o.height()/1.5),window.chart=new Chart(e,{type:"line",data:u,options:{responsive:!0,legend:{position:"bottom"},scales:{xAxes:[{ticks:{maxRotation:0,autoSkip:!0,maxTicksLimit:10}}]}}}),0==r?c.display({begin:i.startDate.format("YYYY-MM-DD"),end:i.endDate.format("YYYY-MM-DD")}):c.update({filter:"all",begin:i.startDate.format("YYYY-MM-DD"),end:i.endDate.format("YYYY-MM-DD")}))}})};d("div[data-ts-filter]").on("click",function(){var t=d(e).data("daterangepicker");d("div[data-ts-filter]").removeClass("active"),d(this).addClass("active"),c.update({filter:d(this).data("ts-filter"),begin:t.startDate.format("YYYY-MM-DD"),end:t.endDate.format("YYYY-MM-DD")})}),n(0)})})(jQuery),(e=>{e(document).on("click","#generate_api_keys",function(){var t=e(this).data("nonce");e.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"turbosmtp_generate_api_keys",turbosmtp_nonce:t},beforeSend:function(){e("#generate_api_keys").prop("disabled",!0).text("Generating...")},success:function(t){t.success?location.href=t.data.next_url:alert("Error: "+(t.message||"Unknown error"))},error:function(t,e,a){alert("AJAX Error: "+a)},complete:function(){e("#generate_api_keys").prop("disabled",!1).text("Generate API Key")}})}),e(document).on("click",".copy-button",function(){var t=e(this).data("target");e("#"+t).select(),document.execCommand("copy"),e("#message_"+t).text("Copied!").fadeIn().delay(2e3).fadeOut()})})(jQuery);